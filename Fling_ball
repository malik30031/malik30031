-- Ø§Ù„Ø®Ø¯Ù…Ø§Øª
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local playerGui = LocalPlayer:WaitForChild("PlayerGui")
local Backpack = LocalPlayer:WaitForChild("Backpack")

-- Ø­Ø°Ù Ø£ÙŠ ÙˆØ§Ø¬Ù‡Ø© Ø£Ùˆ Ø£Ø¯Ø§Ø© Ù‚Ø¯ÙŠÙ…Ø©
local function tryRemoveExistingGuiAndTool()
    local parentsToCheck = {playerGui}
    if gethui then table.insert(parentsToCheck,gethui()) end
    if game:GetService("CoreGui") then table.insert(parentsToCheck,game:GetService("CoreGui")) end
    for _, parent in pairs(parentsToCheck) do
        local oldGui = parent:FindFirstChild("Gui")
        if oldGui then oldGui:Destroy() end
    end
    local oldTool = Backpack:FindFirstChild("SelectPlayer ğŸ‘†")
    if oldTool then oldTool:Destroy() end
end
tryRemoveExistingGuiAndTool()

-- Ø¥Ø´Ø¹Ø§Ø± ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª
pcall(function()
    game.StarterGui:SetCore("SendNotification",{
        Title="Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø§Ù„Ùƒ",
        Text="ØªÙ… ØªØ´ØºÙŠÙ„ Ø³ÙƒØ±Ø¨Øª fling-balls",
        Duration=5
    })
end)

-- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„ÙƒØ±Ø© Ø¹Ù†Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª
local function ensureBall()
    local hasBall = false
    for _, item in ipairs(Backpack:GetChildren()) do
        if item.Name == "SoccerBall" then
            hasBall = true
            break
        end
    end

    if not hasBall then
        pcall(function()
            game.ReplicatedStorage.RE["1Too1l"]:InvokeServer("PickingTools", "SoccerBall")
        end)
    end
end
ensureBall() -- ØªÙ†ÙÙŠØ°Ù‡Ø§ ÙÙˆØ± Ø§Ù„ØªØ´ØºÙŠÙ„

-- Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø©
local Gui = Instance.new("ScreenGui")
Gui.Name = "Gui"
Gui.Parent = gethui and gethui() or playerGui
Gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

local Main = Instance.new("Frame")
Main.Name = "Main"
Main.Parent = Gui
Main.BackgroundColor3 = Color3.fromRGB(0,0,0)
Main.BorderSizePixel = 0
Main.Position = UDim2.new(0.3,0,0.4,0)
Main.Size = UDim2.new(0.3,0,0.25,0)
Main.Active = true
Main.Draggable = true

local Label = Instance.new("TextLabel")
Label.Name = "Label"
Label.Parent = Main
Label.BackgroundColor3 = Color3.fromRGB(255,0,0)
Label.BorderSizePixel = 0
Label.Size = UDim2.new(1,0,0.2,0)
Label.Font = Enum.Font.Nunito
Label.Text = "fling-balls / by: malik30031"
Label.TextColor3 = Color3.fromRGB(255,255,255)
Label.TextScaled = true
Instance.new("UITextSizeConstraint",Label).MaxTextSize = 22

local Box = Instance.new("TextBox")
Box.Name = "Box"
Box.Parent = Main
Box.BackgroundColor3 = Color3.fromRGB(255,0,0)
Box.BorderSizePixel = 0
Box.Position = UDim2.new(0.05,0,0.28,0)
Box.Size = UDim2.new(0.7,0,0.25,0)
Box.Font = Enum.Font.SourceSansBold
Box.PlaceholderText = "Player here"
Box.Text = ""
Box.TextColor3 = Color3.fromRGB(255,255,255)
Box.TextScaled = true
Box.TextWrapped = true
Instance.new("UITextSizeConstraint",Box).MaxTextSize = 31

-- Ø²Ø± Fling Balls
local Button = Instance.new("TextButton")
Button.Name = "Button"
Button.Parent = Main
Button.BackgroundColor3 = Color3.fromRGB(255,0,0)
Button.BorderSizePixel = 0
Button.Position = UDim2.new(0.05,0,0.62,0)
Button.Size = UDim2.new(0.7,0,0.3,0)
Button.Font = Enum.Font.Nunito
Button.Text = "Fling Balls | Off"
Button.TextColor3 = Color3.fromRGB(255,255,255)
Button.TextScaled = true
Button.TextWrapped = true
Instance.new("UITextSizeConstraint",Button).MaxTextSize = 28

-- Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
local Close = Instance.new("TextButton")
Close.Name = "Close"
Close.Parent = Main
Close.Text = "X"
Close.TextColor3 = Color3.fromRGB(255,255,255)
Close.TextScaled = true
Close.BackgroundColor3 = Color3.fromRGB(170,0,0)
Close.BorderSizePixel = 0
Close.Size = UDim2.new(0.12,0,0.2,0)
Close.Position = UDim2.new(0.88,0,0,0)
Close.Font = Enum.Font.Nunito
Close.MouseButton1Click:Connect(function() Gui:Destroy() end)

-- Ø²Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø¨Ø§Ù„Ø£Ø¯Ø§Ø©
local ToolButton = Instance.new("ImageButton")
ToolButton.Name = "ToolButton"
ToolButton.Parent = Main
ToolButton.Image = "rbxassetid://13346150064"
ToolButton.Size = UDim2.new(0.15,0,0.3,0)
ToolButton.Position = UDim2.new(0.77,0,0.27,0)
ToolButton.BackgroundColor3 = Color3.fromRGB(255,0,0)
ToolButton.ImageColor3 = Color3.fromRGB(255,255,255)
ToolButton.BorderSizePixel = 0

-- Ø²Ø± Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© (Ø§Ù„ÙˆØ­ÙŠØ¯ Ø§Ù„Ù„ÙŠ ÙŠØ±Ø§Ù‚Ø¨)
local WatchButton = Instance.new("ImageButton")
WatchButton.Name = "WatchButton"
WatchButton.Parent = Main
WatchButton.Image = "rbxassetid://6031091002"
WatchButton.Size = UDim2.new(0.15,0,0.3,0)
WatchButton.Position = UDim2.new(0.77,0,0.62,0)
WatchButton.BackgroundColor3 = Color3.fromRGB(255,0,0)
WatchButton.ImageColor3 = Color3.fromRGB(255,255,255)
WatchButton.BorderSizePixel = 0

-- Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©
local function getPlayer(name)
    name = name:lower()
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr.Name:lower():find(name) or plr.DisplayName:lower():find(name) then
            return plr
        end
    end
    return nil
end

-- Ø­Ø§Ù„Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„
flingActive = false
local flingThread

-- ÙˆØ¸ÙŠÙØ© FlingBall
local function FlingBall(target)
    ensureBall() -- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„ÙƒØ±Ø©
    local player = Players.LocalPlayer
    local character = player.Character or player.CharacterAdded:Wait()
    local backpack = player:WaitForChild("Backpack")
    local ServerBalls = workspace.WorkspaceCom:WaitForChild("001_SoccerBalls")

    local function GetBall()
        if not backpack:FindFirstChild("SoccerBall") then
            game:GetService("ReplicatedStorage").RE:FindFirstChild("1Too1l"):InvokeServer("PickingTools", "SoccerBall")
        end
        repeat task.wait() until backpack:FindFirstChild("SoccerBall")
        backpack.SoccerBall.Parent = character
        repeat task.wait() until ServerBalls:FindFirstChild("Soccer" .. player.Name)
        character.SoccerBall.Parent = backpack
        return ServerBalls:FindFirstChild("Soccer" .. player.Name)
    end

    local Ball = ServerBalls:FindFirstChild("Soccer" .. player.Name) or GetBall()
    Ball.CanCollide = false
    Ball.Massless = true
    Ball.CustomPhysicalProperties = PhysicalProperties.new(0.0001, 0, 0)

    while flingActive and target and target.Parent == Players do
        local tchar = target.Character or target.CharacterAdded:Wait()
        local troot = tchar:WaitForChild("HumanoidRootPart")
        local thum = tchar:WaitForChild("Humanoid")

        if Ball:FindFirstChildWhichIsA("BodyVelocity") then
            Ball:FindFirstChildWhichIsA("BodyVelocity"):Destroy()
        end

        local bv = Instance.new("BodyVelocity")
        bv.Name = "FlingPower"
        bv.Velocity = Vector3.new(9e8, 9e8, 9e8)
        bv.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
        bv.P = 9e900
        bv.Parent = Ball

        while flingActive and thum.Health > 0 and target.Parent == Players do
            if troot and troot.Parent then
                if troot.Velocity.Magnitude > 0 then
                    local pos = troot.Position + (troot.Velocity / 1.5)
                    Ball.CFrame = CFrame.new(pos)
                    Ball.Orientation += Vector3.new(45, 60, 30)
                else
                    for _, v in pairs(tchar:GetChildren()) do
                        if v:IsA("BasePart") and v.CanCollide and not v.Anchored then
                            Ball.CFrame = v.CFrame
                            task.wait(1/6000)
                        end
                    end
                end
            end
            task.wait(1/6000)
        end

        if flingActive and target then
            target.CharacterAdded:Wait()
            task.wait(1)
        end
    end
end

-- Ø²Ø± ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù FlingBall
Button.MouseButton1Click:Connect(function()
    local p = getPlayer(Box.Text)
    if not p then
        pcall(function()
            game.StarterGui:SetCore("SendNotification",{
                Title="Ø®Ø·Ø£",
                Text="Ù„Ù… ÙŠØªÙ… Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨!",
                Duration=4
            })
        end)
        return
    end

    flingActive = not flingActive
    Button.Text = flingActive and "Fling Balls | On" or "Fling Balls | Off"

    if flingActive then
        flingThread = task.spawn(function()
            FlingBall(p)
        end)
    else
        if flingThread then
            task.cancel(flingThread)
            flingThread = nil
        end
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            workspace.CurrentCamera.CameraSubject = LocalPlayer.Character.Humanoid
        end
    end
end)

-- Ø²Ø± Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©
local watching = false
local currentTarget
local function watchPlayer(target)
    if not target or not target.Character then return end
    local humanoid = target.Character:FindFirstChild("Humanoid")
    if humanoid then
        workspace.CurrentCamera.CameraSubject = humanoid
    end
end
WatchButton.MouseButton1Click:Connect(function()
    local target = getPlayer(Box.Text)
    if target then
        watching = not watching
        currentTarget = target
        if watching then
            WatchButton.ImageColor3 = Color3.fromRGB(255,0,0)
            WatchButton.BackgroundColor3 = Color3.fromRGB(255,255,255)
            watchPlayer(currentTarget)
        else
            WatchButton.ImageColor3 = Color3.fromRGB(255,255,255)
            WatchButton.BackgroundColor3 = Color3.fromRGB(255,0,0)
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                workspace.CurrentCamera.CameraSubject = LocalPlayer.Character.Humanoid
            end
        end
    else
        warn("Ø§Ù„Ù„Ø§Ø¹Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø£Ùˆ Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø´Ø®ØµÙŠØªÙ‡")
    end
end)
RunService.Heartbeat:Connect(function()
    if watching and currentTarget then
        if currentTarget.Character and currentTarget.Character:FindFirstChild("Humanoid") then
            workspace.CurrentCamera.CameraSubject = currentTarget.Character.Humanoid
        end
    end
end)

-- Ø²Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø¨Ø§Ù„Ø£Ø¯Ø§Ø©
ToolButton.MouseButton1Click:Connect(function()
    local exists=Backpack:FindFirstChild("SelectPlayer ğŸ‘†") or (LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("SelectPlayer ğŸ‘†"))
    if exists then
        pcall(function()
            game.StarterGui:SetCore("SendNotification",{
                Title="Ø§Ù„Ø£Ø¯Ø§Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¨Ø§Ù„ÙØ¹Ù„",
                Text="Ø£Ù†Øª ØªÙ…Ù„Ùƒ Ø§Ù„Ø£Ø¯Ø§Ø© Ø­Ø§Ù„ÙŠÙ‹Ø§",
                Duration=4
            })
        end)
    else
        local tool=Instance.new("Tool")
        tool.RequiresHandle=false
        tool.Name="SelectPlayer ğŸ‘†"
        tool.TextureId="rbxassetid://13346150064"
        tool.Parent=Backpack
        tool.Activated:Connect(function()
            local mouse=LocalPlayer:GetMouse()
            local target=mouse.Target
            if target then
                local model=target:FindFirstAncestorOfClass("Model")
                if model and Players:GetPlayerFromCharacter(model) then
                    local plr=Players:GetPlayerFromCharacter(model)
                    Box.Text=plr.Name
                    pcall(function()
                        game.StarterGui:SetCore("SendNotification",{
                            Title="ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ù„Ø§Ø¹Ø¨",
                            Text=plr.Name,
                            Icon="https://www.roblox.com/headshot-thumbnail/image?userId="..plr.UserId.."&width=420&height=420&format=png",
                            Duration=3
                        })
                    end)
                end
            end
        end)
        pcall(function()
            game.StarterGui:SetCore("SendNotification",{
                Title="Ø§Ù„Ø£Ø¯Ø§Ø© Ù…Ø¶Ø§ÙØ©",
                Text="Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù„ØªØ­Ø¯ÙŠØ¯Ù‡",
                Duration=4
            })
        end)
    end
end)

-- Ø§Ø®ØªØµØ§Ø± Ù„Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
UserInputService.InputBegan:Connect(function(input,gpe)
    if input.KeyCode==Enum.KeyCode.RightControl and not gpe then
        Main.Visible=not Main.Visible
    end
end)
